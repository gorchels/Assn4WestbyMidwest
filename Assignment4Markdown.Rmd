---
title: "Assignment4"
author: "Madeline Gorchels"
date: "11/10/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, echo=FALSE, message=FALSE}
#Loading packages and data sets (see note below)

library(tidyverse)
library(effsize)
library(knitr)
library(kableExtra)
library(vcdExtra) # Based on instructions it looks like this may be necissary -you'll need to instal this if you haven't already

lob_ab = read_csv("lobster_size_abundance.csv")
lob_trap = read_csv("lobster_traps.csv")

```

# "Lobster abundance and fishing pressure (2012 - 2017)"

Describe trends in lobster abundance (counts) and fishing pressure (trap buoys) at the five locations from
2012 - 2017. Ignore transect information - we are only interested in evaluating abundance and pressure on the
order of SITE. Note: you are not expected to use regression here - just think of ways to clearly
describe annual totals visually and in text, noting important trends, events and differences.


```{r}

tidy_lob_ab <- expand.dft(data.frame(lob_ab), freq = "COUNT") # Data in tidy format

lob_ab_hist <- ggplot(tidy_lob_ab, aes(SIZE)) +
  geom_histogram(aes(fill = SITE)) +
  facet_wrap(~SITE)

lob_ab_hist

lob_ab_hist_stack <- ggplot(tidy_lob_ab, aes(SIZE)) +
  geom_histogram(aes(fill = SITE)) 

lob_ab_hist_stack
```

```{r}

lob_ab_year <- group_by(tidy_lob_ab, "YEAR") 

# Plotting changes in time for AQUE
aque_ab_summary <- filter(lob_ab_year, SITE == "AQUE") %>% 
  group_by(YEAR) %>% 
  summarize( 
   mean_size_aque = round(mean(SIZE), 2))

aque_lob_ab_hist <- ggplot(data = aque_ab_summary, 
                           aes(x = YEAR,
                               y = mean_size_aque)) +
  geom_col()

aque_lob_ab_hist


# Plotting changes in time for CARP
CARP_ab_summary <- filter(lob_ab_year, SITE == "CARP") %>% 
  group_by(YEAR) %>% 
  summarize( 
   mean_size_CARP = round(mean(SIZE), 2))

CARP_lob_ab_hist <- ggplot(data = CARP_ab_summary, 
                           aes(x = YEAR,
                               y = mean_size_CARP)) +
  geom_col()

CARP_lob_ab_hist


# Plotting changes in time for IVEE
IVEE_ab_summary <- filter(lob_ab_year, SITE == "IVEE") %>% 
  group_by(YEAR) %>% 
  summarize( 
   mean_size_IVEE = round(mean(SIZE), 2))

IVEE_lob_ab_hist <- ggplot(data = IVEE_ab_summary, 
                           aes(x = YEAR,
                               y = mean_size_IVEE)) +
  geom_col()

IVEE_lob_ab_hist


# Plotting changes in time for MOHK
MOHK_ab_summary <- filter(lob_ab_year, SITE == "MOHK") %>% 
  group_by(YEAR) %>% 
  summarize( 
   mean_size_MOHK = round(mean(SIZE), 2))

MOHK_lob_ab_hist <- ggplot(data = MOHK_ab_summary, 
                           aes(x = YEAR,
                               y = mean_size_MOHK)) +
  geom_col()

MOHK_lob_ab_hist



# Plotting changes in time for NAPL
NAPL_ab_summary <- filter(lob_ab_year, SITE == "NAPL") %>% 
  group_by(YEAR) %>% 
  summarize( 
   mean_size_NAPL = round(mean(SIZE), 2))

NAPL_lob_ab_hist <- ggplot(data = NAPL_ab_summary, 
                           aes(x = YEAR,
                               y = mean_size_NAPL)) +
  geom_col()

NAPL_lob_ab_hist
```




```{r}
lob_trap_filtered <- filter(lob_trap, SITE == c("AQUE","CARP","IVEE","MOHK","NAPL"))  # I get a warning message so I need to confirm this is ok

lob_trap_hist <- ggplot(lob_trap_filtered, aes(TRAPS)) +
  geom_histogram(aes(fill = SITE)) +
  facet_wrap(~SITE)

lob_trap_hist

```


```{r}
lob_trap_year <- group_by(lob_trap_filtered, "YEAR") 

# Plotting changes in time for AQUE
aque_trap_summary <- filter(lob_trap_year, SITE == "AQUE") %>% 
  group_by(YEAR) %>% 
  summarize( 
   mean_trap_aque = round(mean(TRAPS), 2))

aque_lob_trap_hist <- ggplot(data = aque_trap_summary, 
                           aes(x = YEAR,
                               y = mean_trap_aque)) +
  geom_col()

aque_lob_trap_hist



# Plotting changes in time for CARP
CARP_trap_summary <- filter(lob_trap_year, SITE == "CARP") %>% 
  group_by(YEAR) %>% 
  summarize( 
   mean_trap_CARP = round(mean(TRAPS), 2))

CARP_lob_trap_hist <- ggplot(data = CARP_trap_summary, 
                           aes(x = YEAR,
                               y = mean_trap_CARP)) +
  geom_col()

CARP_lob_trap_hist



# Plotting changes in time for IVEE
IVEE_trap_summary <- filter(lob_trap_year, SITE == "IVEE") %>% 
  group_by(YEAR) %>% 
  summarize( 
   mean_trap_IVEE = round(mean(TRAPS), 2))

IVEE_lob_trap_hist <- ggplot(data = IVEE_trap_summary, 
                           aes(x = YEAR,
                               y = mean_trap_IVEE)) +
  geom_col()

IVEE_lob_trap_hist



# Plotting changes in time for MOHK
MOHK_trap_summary <- filter(lob_trap_year, SITE == "MOHK") %>% 
  group_by(YEAR) %>% 
  summarize( 
   mean_trap_MOHK = round(mean(TRAPS), 2))

MOHK_lob_trap_hist <- ggplot(data = MOHK_trap_summary, 
                           aes(x = YEAR,
                               y = mean_trap_MOHK)) +
  geom_col()

MOHK_lob_trap_hist




# Plotting changes in time for NAPL
NAPL_trap_summary <- filter(lob_trap_year, SITE == "NAPL") %>% 
  group_by(YEAR) %>% 
  summarize( 
   mean_trap_NAPL = round(mean(TRAPS), 2))

NAPL_lob_trap_hist <- ggplot(data = NAPL_trap_summary, 
                           aes(x = YEAR,
                               y = mean_trap_NAPL)) +
  geom_col()

NAPL_lob_trap_hist
```





# "Compare mean lobster size by site in 2017"

```{r}
lob_size_2017 <- select(tidy_lob_ab, YEAR, SITE, SIZE) %>%  # Select relevant categories. Note, depending on how the we make the file tidy, the first term may need to change 
  filter(YEAR == "2017") %>% 
  group_by(SITE)
```

Test to see if the pushing works for me (Becky)



